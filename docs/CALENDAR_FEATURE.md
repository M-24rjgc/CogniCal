# 📅 内置日历功能

## 概述

新增了完整的内置日历视图，替代了原有的外部日历同步功能。用户可以在月视图中查看所有任务和规划时间块。

## 主要功能

### 1. 月视图日历
- **完整的月历展示**：显示当前月份的所有日期
- **周一开始**：符合中国用户习惯
- **今日高亮**：当前日期用主题色标记
- **跨月显示**：自动显示上月和下月的部分日期

### 2. 任务和时间块可视化
- **任务显示**：
  - 截止日期的任务显示在对应日期
  - 开始日期的任务也会显示
  - 已完成任务用绿色标记
  - 进行中任务用蓝色标记
  
- **规划时间块**：
  - 显示 AI 生成的规划时间块
  - 显示时间段（如 09:00）
  - 用主题色区分

### 3. 日期详情面板
点击任何日期，右侧会显示详情面板：
- **规划时间块列表**：
  - 任务标题
  - 开始-结束时间
  - 持续时长
  - 置信度和灵活度
  
- **任务列表**：
  - 任务标题和描述
  - 状态和优先级
  - 截止时间

### 4. 交互功能
- **点击日期**：查看该日期的详细信息
- **点击任务**：打开任务详情抽屉
- **点击时间块**：查看对应任务的详情
- **月份导航**：前后月份切换
- **今天按钮**：快速回到当前月份

### 5. 统计信息
右侧边栏显示本月概览：
- 总任务数
- 已完成任务数
- 进行中任务数
- 规划时间块数量

### 6. 视觉指示器
- **完成进度条**：每个日期底部显示任务完成进度
- **数量徽章**：显示每天的任务和时间块总数
- **颜色编码**：
  - 蓝色：有任务
  - 主题色：已规划
  - 绿色：已完成

## 技术实现

### 新增组件

1. **CalendarView** (`src/components/calendar/CalendarView.tsx`)
   - 月视图日历主组件
   - 自动计算日历网格（42天，6周）
   - 响应式布局

2. **DayDetailPanel** (`src/components/calendar/DayDetailPanel.tsx`)
   - 日期详情侧边栏
   - 显示任务和时间块列表
   - 支持点击交互

### 更新的页面

- **Calendar.tsx** (`src/pages/Calendar.tsx`)
  - 完全重构，使用新的日历组件
  - 移除了 `hasEventBridge` 依赖
  - 添加了任务详情抽屉集成

## 使用方法

1. **查看日历**：
   - 点击侧边栏的"日历视图"
   - 自动显示当前月份

2. **查看日期详情**：
   - 点击任何日期格子
   - 右侧显示该日期的任务和时间块

3. **查看任务详情**：
   - 在日历格子中点击任务
   - 或在日期详情面板中点击任务
   - 打开任务详情抽屉

4. **导航**：
   - 使用左右箭头切换月份
   - 点击"今天"按钮回到当前月份

## 优势

相比原有的"规划时间线"视图：

1. **更直观**：月视图一目了然
2. **更易用**：点击交互更自然
3. **更完整**：同时显示任务和规划
4. **无依赖**：不需要外部日历同步
5. **更美观**：现代化的 UI 设计

## 未来改进

可能的增强功能：
- [ ] 周视图和日视图
- [ ] 拖拽调整任务时间
- [ ] 直接在日历上创建任务
- [ ] 导出日历为 iCal 格式
- [ ] 打印日历功能
- [ ] 自定义颜色主题
