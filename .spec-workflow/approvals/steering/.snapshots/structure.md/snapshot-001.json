{
  "id": "snapshot_1760082259289_imtnmfxbk",
  "approvalId": "approval_1760082259251_t9l1vru7f",
  "approvalTitle": "更新steering文档以反映Phase 1完成情况",
  "version": 1,
  "timestamp": "2025-10-10T07:44:19.289Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Project Structure\r\n\r\n## Repository Overview\r\n\r\n```\r\nCogniCal/\r\n├── src-tauri/               # Tauri Rust backend\r\n│   ├── src/\r\n│   │   ├── main.rs         # Application entry point\r\n│   │   ├── commands/       # Tauri command handlers\r\n│   │   │   ├── mod.rs\r\n│   │   │   ├── task.rs     # Task CRUD commands\r\n│   │   │   ├── calendar.rs # Calendar operations\r\n│   │   │   ├── ai.rs       # AI integration commands\r\n│   │   │   ├── analytics.rs # Analytics commands\r\n│   │   │   └── habit.rs    # Habit tracking commands\r\n│   │   ├── services/       # Business logic layer\r\n│   │   │   ├── mod.rs\r\n│   │   │   ├── task_service.rs\r\n│   │   │   ├── calendar_service.rs\r\n│   │   │   ├── ai_service.rs\r\n│   │   │   ├── cot_engine.rs      # CoT reasoning engine\r\n│   │   │   ├── mcts_solver.rs     # MCTS task decomposition\r\n│   │   │   ├── analytics_service.rs\r\n│   │   │   └── habit_service.rs\r\n│   │   ├── agents/         # Dual-agent system\r\n│   │   │   ├── mod.rs\r\n│   │   │   ├── task_planning_agent.rs\r\n│   │   │   └── life_assistant_agent.rs\r\n│   │   ├── db/             # Database layer\r\n│   │   │   ├── mod.rs\r\n│   │   │   ├── connection.rs      # SQLite connection pool\r\n│   │   │   ├── migrations.rs      # Schema migrations\r\n│   │   │   └── models/            # Database models\r\n│   │   │       ├── mod.rs\r\n│   │   │       ├── task.rs\r\n│   │   │       ├── calendar.rs\r\n│   │   │       ├── habit.rs\r\n│   │   │       └── analytics.rs\r\n│   │   ├── utils/          # Utility functions\r\n│   │   │   ├── mod.rs\r\n│   │   │   ├── datetime.rs\r\n│   │   │   ├── validation.rs\r\n│   │   │   └── cache.rs\r\n│   │   └── error.rs        # Custom error types\r\n│   ├── Cargo.toml          # Rust dependencies\r\n│   ├── tauri.conf.json     # Tauri configuration\r\n│   └── icons/              # Application icons\r\n├── src/                     # React frontend\r\n│   ├── main.tsx            # Application entry point\r\n│   ├── App.tsx             # Root component\r\n│   ├── components/         # React components\r\n│   │   ├── common/         # Shared components\r\n│   │   │   ├── Button.tsx\r\n│   │   │   ├── Input.tsx\r\n│   │   │   ├── Modal.tsx\r\n│   │   │   ├── Loading.tsx\r\n│   │   │   └── ErrorBoundary.tsx\r\n│   │   ├── layout/         # Layout components\r\n│   │   │   ├── Sidebar.tsx\r\n│   │   │   ├── Header.tsx\r\n│   │   │   └── MainLayout.tsx\r\n│   │   ├── task/           # Task management\r\n│   │   │   ├── TaskList.tsx\r\n│   │   │   ├── TaskItem.tsx\r\n│   │   │   ├── TaskForm.tsx\r\n│   │   │   ├── TaskDetails.tsx\r\n│   │   │   ├── TaskDecomposition.tsx\r\n│   │   │   └── DependencyGraph.tsx\r\n│   │   ├── calendar/       # Calendar views\r\n│   │   │   ├── CalendarView.tsx\r\n│   │   │   ├── DayView.tsx\r\n│   │   │   ├── WeekView.tsx\r\n│   │   │   ├── MonthView.tsx\r\n│   │   │   └── TimeBlock.tsx\r\n│   │   ├── analytics/      # Analytics dashboard\r\n│   │   │   ├── Dashboard.tsx\r\n│   │   │   ├── ProductivityChart.tsx\r\n│   │   │   ├── TimeDistribution.tsx\r\n│   │   │   ├── EfficiencyMetrics.tsx\r\n│   │   │   └── TrendAnalysis.tsx\r\n│   │   ├── habit/          # Habit tracking\r\n│   │   │   ├── HabitList.tsx\r\n│   │   │   ├── HabitCard.tsx\r\n│   │   │   ├── HabitForm.tsx\r\n│   │   │   └── StreakDisplay.tsx\r\n│   │   ├── ai/             # AI interaction\r\n│   │   │   ├── ChatInterface.tsx\r\n│   │   │   ├── CotDisplay.tsx\r\n│   │   │   └── RecommendationPanel.tsx\r\n│   │   └── settings/       # Settings\r\n│   │       ├── SettingsPanel.tsx\r\n│   │       ├── ApiKeyManager.tsx\r\n│   │       └── Preferences.tsx\r\n│   ├── pages/              # Page-level components\r\n│   │   ├── Home.tsx\r\n│   │   ├── Tasks.tsx\r\n│   │   ├── Calendar.tsx\r\n│   │   ├── Analytics.tsx\r\n│   │   ├── Habits.tsx\r\n│   │   └── Settings.tsx\r\n│   ├── hooks/              # Custom React hooks\r\n│   │   ├── useTasks.ts\r\n│   │   ├── useCalendar.ts\r\n│   │   ├── useAnalytics.ts\r\n│   │   ├── useHabits.ts\r\n│   │   ├── useAI.ts\r\n│   │   └── useTauriCommands.ts\r\n│   ├── stores/             # Zustand stores\r\n│   │   ├── taskStore.ts\r\n│   │   ├── calendarStore.ts\r\n│   │   ├── uiStore.ts\r\n│   │   └── settingsStore.ts\r\n│   ├── services/           # Frontend services\r\n│   │   ├── tauriApi.ts     # Tauri command wrappers\r\n│   │   └── localCache.ts   # Local storage utilities\r\n│   ├── types/              # TypeScript types\r\n│   │   ├── task.ts\r\n│   │   ├── calendar.ts\r\n│   │   ├── analytics.ts\r\n│   │   ├── habit.ts\r\n│   │   └── ai.ts\r\n│   ├── utils/              # Utility functions\r\n│   │   ├── datetime.ts\r\n│   │   ├── formatters.ts\r\n│   │   ├── validators.ts\r\n│   │   └── constants.ts\r\n│   ├── styles/             # Global styles\r\n│   │   ├── globals.css\r\n│   │   └── tailwind.css\r\n│   └── assets/             # Static assets\r\n│       ├── images/\r\n│       └── icons/\r\n├── public/                  # Public assets\r\n├── tests/                   # Test files\r\n│   ├── unit/               # Unit tests\r\n│   │   ├── rust/\r\n│   │   └── typescript/\r\n│   ├── integration/        # Integration tests\r\n│   └── e2e/                # End-to-end tests\r\n│       └── playwright/\r\n├── docs/                    # Documentation\r\n│   ├── api/                # API documentation\r\n│   ├── architecture/       # Architecture docs\r\n│   └── user-guide/         # User documentation\r\n├── scripts/                 # Build and utility scripts\r\n│   ├── setup.sh\r\n│   ├── build.sh\r\n│   └── release.sh\r\n├── .github/                 # GitHub workflows\r\n│   └── workflows/\r\n│       ├── ci.yml\r\n│       ├── release.yml\r\n│       └── test.yml\r\n├── .spec-workflow/          # Spec workflow documents\r\n│   ├── steering/\r\n│   │   ├── product.md\r\n│   │   ├── tech.md\r\n│   │   └── structure.md\r\n│   └── specs/              # Feature specifications\r\n├── .vscode/                 # VSCode settings\r\n│   ├── settings.json\r\n│   └── extensions.json\r\n├── package.json             # Frontend dependencies\r\n├── pnpm-lock.yaml\r\n├── tsconfig.json            # TypeScript configuration\r\n├── vite.config.ts           # Vite configuration\r\n├── tailwind.config.js       # Tailwind configuration\r\n├── postcss.config.js        # PostCSS configuration\r\n├── .eslintrc.json           # ESLint configuration\r\n├── .prettierrc              # Prettier configuration\r\n├── .gitignore\r\n├── README.md\r\n├── LICENSE\r\n└── CHANGELOG.md\r\n```\r\n\r\n## Key Directory Explanations\r\n\r\n### `src-tauri/` (Rust Backend)\r\n\r\n**Purpose**: Tauri application backend containing all Rust code for business logic, database operations, and system integration.\r\n\r\n**Key Components**:\r\n\r\n- `commands/`: Tauri command handlers exposed to frontend via IPC\r\n- `services/`: Core business logic and algorithms\r\n- `agents/`: Dual-agent AI system implementation\r\n- `db/`: Database models, migrations, and connection management\r\n- `utils/`: Shared utility functions\r\n\r\n**Ownership**: Backend team, Rust developers\r\n\r\n---\r\n\r\n### `src/` (React Frontend)\r\n\r\n**Purpose**: User interface layer built with React, TypeScript, and Tailwind CSS.\r\n\r\n**Key Components**:\r\n\r\n- `components/`: Reusable UI components organized by feature\r\n- `pages/`: Top-level page components corresponding to routes\r\n- `hooks/`: Custom React hooks for state management and side effects\r\n- `stores/`: Zustand global state stores\r\n- `types/`: TypeScript type definitions\r\n- `services/`: Frontend service layer for API communication\r\n\r\n**Ownership**: Frontend team, UI/UX developers\r\n\r\n---\r\n\r\n### `tests/`\r\n\r\n**Purpose**: Comprehensive test suite covering unit, integration, and E2E tests.\r\n\r\n**Key Components**:\r\n\r\n- `unit/`: Fast, isolated tests for individual functions/components\r\n- `integration/`: Tests for component/service interactions\r\n- `e2e/`: Full user flow tests using Playwright\r\n\r\n**Ownership**: QA team, all developers (TDD approach)\r\n\r\n---\r\n\r\n### `docs/`\r\n\r\n**Purpose**: Technical documentation for developers and users.\r\n\r\n**Key Components**:\r\n\r\n- `api/`: API reference for Tauri commands\r\n- `architecture/`: System design documents\r\n- `user-guide/`: End-user documentation\r\n\r\n**Ownership**: Tech writers, senior developers\r\n\r\n---\r\n\r\n### `.spec-workflow/`\r\n\r\n**Purpose**: Specification-driven development workflow documents.\r\n\r\n**Key Components**:\r\n\r\n- `steering/`: High-level product, tech, and structure documents\r\n- `specs/`: Feature-specific specifications\r\n\r\n**Ownership**: Product managers, tech leads\r\n\r\n## File Naming Conventions\r\n\r\n### Rust Files\r\n\r\n- **Snake case**: `task_service.rs`, `cot_engine.rs`\r\n- **Module files**: `mod.rs` for module exports\r\n- **Descriptive names**: Clearly indicate the file's purpose\r\n\r\n### TypeScript/React Files\r\n\r\n- **PascalCase for components**: `TaskList.tsx`, `CalendarView.tsx`\r\n- **camelCase for utilities**: `useTasks.ts`, `datetime.ts`\r\n- **Type files**: Match the feature name (e.g., `task.ts` for task types)\r\n\r\n### Test Files\r\n\r\n- **Suffix with `.test` or `.spec`**: `task_service.test.rs`, `TaskList.spec.tsx`\r\n- **Mirror source structure**: Tests in same directory structure as source\r\n\r\n## Configuration Files\r\n\r\n### `tauri.conf.json`\r\n\r\n- **Purpose**: Tauri application configuration\r\n- **Key Settings**:\r\n  - App metadata (name, version, description)\r\n  - Window configuration (size, decorations)\r\n  - Security settings (CSP, allowlist)\r\n  - Build targets and bundles\r\n\r\n### `package.json`\r\n\r\n- **Purpose**: Frontend dependencies and scripts\r\n- **Key Sections**:\r\n  - Dependencies (React, Tailwind, etc.)\r\n  - Dev dependencies (Vite, TypeScript, etc.)\r\n  - Scripts (dev, build, test)\r\n\r\n### `Cargo.toml`\r\n\r\n- **Purpose**: Rust dependencies and project metadata\r\n- **Key Sections**:\r\n  - Package metadata\r\n  - Dependencies (Tauri, SQLite, reqwest, etc.)\r\n  - Build configuration\r\n\r\n### `tsconfig.json`\r\n\r\n- **Purpose**: TypeScript compiler configuration\r\n- **Key Settings**:\r\n  - Target ES version\r\n  - Module resolution strategy\r\n  - Path aliases (@/ for src/)\r\n  - Strict type checking\r\n\r\n### `vite.config.ts`\r\n\r\n- **Purpose**: Vite build tool configuration\r\n- **Key Settings**:\r\n  - Tauri plugin integration\r\n  - Path aliases\r\n  - Build optimization\r\n  - Development server settings\r\n\r\n## Build Artifacts\r\n\r\n### Development\r\n\r\n```\r\ntarget/              # Rust build artifacts\r\n  └── debug/         # Debug builds\r\nnode_modules/        # Frontend dependencies\r\ndist/                # Vite build output\r\n```\r\n\r\n### Production\r\n\r\n```\r\nsrc-tauri/target/\r\n  └── release/       # Optimized Rust builds\r\n      └── bundle/    # Platform-specific installers\r\n          ├── dmg/   # macOS installers\r\n          ├── msi/   # Windows installers\r\n          └── deb/   # Linux packages\r\n```\r\n\r\n## Development Workflow\r\n\r\n### 1. Feature Development\r\n\r\n```\r\n1. Create feature spec in .spec-workflow/specs/\r\n2. Implement Rust services in src-tauri/services/\r\n3. Create Tauri commands in src-tauri/commands/\r\n4. Build React components in src/components/\r\n5. Write tests in tests/\r\n6. Update documentation in docs/\r\n```\r\n\r\n### 2. Branch Strategy\r\n\r\n```\r\nmain                 # Production-ready code\r\n  ├── develop        # Integration branch\r\n  │   ├── feature/*  # Feature branches\r\n  │   ├── bugfix/*   # Bug fix branches\r\n  │   └── refactor/* # Refactoring branches\r\n  └── hotfix/*       # Urgent production fixes\r\n```\r\n\r\n### 3. Code Review Process\r\n\r\n```\r\n1. Create PR from feature branch to develop\r\n2. Automated CI checks (lint, test, build)\r\n3. Code review by at least 2 developers\r\n4. Address feedback and re-review\r\n5. Merge to develop after approval\r\n6. Deploy to staging for QA testing\r\n```\r\n\r\n## Module Dependencies\r\n\r\n### Backend Dependencies\r\n\r\n```\r\nmain.rs\r\n  ├── commands/*      → services/*\r\n  ├── services/*      → db/*, agents/*\r\n  ├── agents/*        → services/*\r\n  └── db/*            → No internal dependencies\r\n```\r\n\r\n### Frontend Dependencies\r\n\r\n```\r\nApp.tsx\r\n  ├── pages/*         → components/*, hooks/*\r\n  ├── components/*    → hooks/*, services/*, types/*\r\n  ├── hooks/*         → services/*, stores/*\r\n  ├── stores/*        → types/*\r\n  └── services/*      → types/*\r\n```\r\n\r\n## Data Flow Architecture\r\n\r\n### Task Creation Flow\r\n\r\n```\r\nUser Input (UI)\r\n  ↓\r\nTaskForm.tsx (Component)\r\n  ↓\r\nuseTasks.ts (Hook)\r\n  ↓\r\ntauriApi.ts (Service)\r\n  ↓ [Tauri IPC]\r\ncommands/task.rs (Command Handler)\r\n  ↓\r\nservices/task_service.rs (Business Logic)\r\n  ↓\r\nservices/ai_service.rs (AI Integration)\r\n  ↓\r\ndb/models/task.rs (Data Access)\r\n  ↓\r\nSQLite Database\r\n  ↓ [Response]\r\nBack to UI (State Update)\r\n```\r\n\r\n### Analytics Dashboard Flow\r\n\r\n```\r\nUser Opens Dashboard (UI)\r\n  ↓\r\nDashboard.tsx (Component)\r\n  ↓\r\nuseAnalytics.ts (Hook)\r\n  ↓\r\ntauriApi.ts (Service)\r\n  ↓ [Tauri IPC]\r\ncommands/analytics.rs (Command Handler)\r\n  ↓\r\nservices/analytics_service.rs (Business Logic)\r\n  ↓\r\ndb/models/analytics.rs (Data Access)\r\n  ↓\r\nSQLite Database\r\n  ↓ [Response]\r\nRender Charts and Metrics (UI)\r\n```\r\n\r\n## Environment Configuration\r\n\r\n### Development Environment\r\n\r\n```env\r\n# .env.development\r\nVITE_API_ENV=development\r\nVITE_LOG_LEVEL=debug\r\nTAURI_ENV=development\r\n```\r\n\r\n### Production Environment\r\n\r\n```env\r\n# .env.production\r\nVITE_API_ENV=production\r\nVITE_LOG_LEVEL=warn\r\nTAURI_ENV=production\r\n```\r\n\r\n### API Keys (Stored in OS Keychain)\r\n\r\n- DeepSeek API Key: Managed by Tauri secure storage\r\n- No sensitive data in repository\r\n\r\n## Deployment Structure\r\n\r\n### Release Artifacts\r\n\r\n```\r\nCogniCal-1.0.0/\r\n├── Windows/\r\n│   ├── CogniCal_1.0.0_x64.msi\r\n│   └── CogniCal_1.0.0_x64_en-US.msi.zip\r\n├── macOS/\r\n│   ├── CogniCal_1.0.0_x64.dmg\r\n│   └── CogniCal_1.0.0_aarch64.dmg\r\n├── Linux/\r\n│   ├── CogniCal_1.0.0_amd64.deb\r\n│   └── CogniCal_1.0.0_amd64.AppImage\r\n└── checksums.txt\r\n```\r\n\r\n## Documentation Structure\r\n\r\n### API Documentation\r\n\r\n```\r\ndocs/api/\r\n├── tauri-commands.md      # Complete command reference\r\n├── types.md               # TypeScript type definitions\r\n└── error-codes.md         # Error handling guide\r\n```\r\n\r\n### Architecture Documentation\r\n\r\n```\r\ndocs/architecture/\r\n├── system-overview.md     # High-level architecture\r\n├── data-flow.md           # Data flow diagrams\r\n├── ai-integration.md      # AI/CoT implementation details\r\n└── security.md            # Security considerations\r\n```\r\n\r\n### User Documentation\r\n\r\n```\r\ndocs/user-guide/\r\n├── getting-started.md     # Installation and setup\r\n├── features.md            # Feature walkthrough\r\n├── tips-and-tricks.md     # Best practices\r\n└── faq.md                 # Common questions\r\n```\r\n\r\n## Scalability Considerations\r\n\r\n### Current Phase (Phase 1 - 智能任务解析)\r\n\r\n- ✅ Tauri 2 + React 基础架构完成\r\n- ✅ 模块化前端组件结构\r\n- ✅ Rust 后端服务层分离\r\n- ✅ SQLite 数据库与迁移系统\r\n- Monolithic application structure\r\n- Single-user focus\r\n- Local-only data storage\r\n\r\n### Future Phases\r\n\r\n- **Plugin System**: `src/plugins/` for extensions\r\n- **Multi-user Support**: `src-tauri/sync/` for P2P sync\r\n- **Web Version**: Separate `src-web/` directory\r\n- **Mobile Apps**: Consider React Native rewrite\r\n\r\n## Maintenance & Monitoring\r\n\r\n### Log Files Location\r\n\r\n- **Development**: Console output\r\n- **Production**:\r\n  - Windows: `%APPDATA%\\CogniCal\\logs\\`\r\n  - macOS: `~/Library/Logs/CogniCal/`\r\n  - Linux: `~/.local/share/CogniCal/logs/`\r\n\r\n### Database Location\r\n\r\n- **Windows**: `%APPDATA%\\CogniCal\\data\\cognical.db`\r\n- **macOS**: `~/Library/Application Support/CogniCal/cognical.db`\r\n- **Linux**: `~/.local/share/CogniCal/cognical.db`\r\n\r\n### Backup Strategy\r\n\r\n- Automated daily backups to `{data_dir}/backups/`\r\n- 7-day retention policy\r\n- Manual export to user-specified location\r\n",
  "fileStats": {
    "size": 17344,
    "lines": 558,
    "lastModified": "2025-10-10T07:43:52.394Z"
  },
  "comments": []
}