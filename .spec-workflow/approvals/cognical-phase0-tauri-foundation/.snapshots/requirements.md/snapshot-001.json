{
  "id": "snapshot_1759865094161_weq2tbxtn",
  "approvalId": "approval_1759865094144_62jqpdfhu",
  "approvalTitle": "Review requirements for cognical-phase0-tauri-foundation",
  "version": 1,
  "timestamp": "2025-10-07T19:24:54.161Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Requirements Document\r\n\r\n## Introduction\r\n\r\nCogniCal 的 Phase 0 基础架构交付旨在构建一套跨平台的 Tauri 2 桌面应用外壳，提供统一的任务管理骨架、核心交互界面与数据持久化能力。通过完成项目初始化、主题化 UI、基础导航以及任务与日历的核心体验，确保后续智能化能力能够在稳定可靠的桌面环境中快速迭代。\r\n\r\n## Alignment with Product Vision\r\n\r\n该基础版本支撑产品愿景中“隐私至上、离线优先、智能但透明”的目标：它提供一个原生性能的本地桌面应用外壳，确保所有任务数据默认保存在本地 SQLite 中，并具备高效的 UI 与系统集成能力，为后续 AI 推理、双智能体协作和深度数据洞察奠定基础。\r\n\r\n## Requirements\r\n\r\n### Requirement 1\r\n\r\n**User Story:** 作为一名需要高效处理日程的知识型工作者，我想要一个原生体验的 CogniCal 桌面应用外壳，以便无需浏览器也能快速进入工作流。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户启动应用 THEN 系统 SHALL 在目标硬件（8GB RAM、SSD）上 2 秒内加载并呈现主界面。\r\n2. IF 用户修改主题偏好（深色/浅色） THEN 系统 SHALL 即时切换主题并在本地持久化该设置。\r\n3. WHEN 应用检测到当前无网络 THEN 系统 SHALL 允许用户继续访问任务列表与日历数据而不出现功能缺失提示。\r\n\r\n### Requirement 2\r\n\r\n**User Story:** 作为一名需要记录大量任务的个人生产力用户，我想要创建、编辑、删除任务并查看详细信息，以便掌握工作进度。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户提交包含标题、描述、优先级、计划开始时间、截止时间、预估工时、任务类型和标签的任务表单 THEN 系统 SHALL 验证字段完整性并将任务写入本地 SQLite，随后在任务列表中即时展示。\r\n2. IF 用户遗漏任一必填字段 THEN 系统 SHALL 在对应字段显示校验消息并阻止提交。\r\n3. WHEN 用户更新或删除现有任务 THEN 系统 SHALL 在 100ms 内同步更新本地存储并刷新任务列表与详情视图。\r\n\r\n### Requirement 3\r\n\r\n**User Story:** 作为一名希望直观查看时间安排的用户，我想在日/周视图中看到任务日程，以便快速调整计划。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户在任务创建或编辑时提供计划时间段 THEN 系统 SHALL 自动在日历视图中渲染对应时间块。\r\n2. IF 用户在日历视图拖拽任务块到新的时间段 THEN 系统 SHALL 更新任务的计划开始与截止时间并写入数据库。\r\n3. WHEN 用户切换日视图与周视图 THEN 系统 SHALL 在 200ms 内完成视图切换并保持当前日期上下文。\r\n\r\n### Requirement 4\r\n\r\n**User Story:** 作为一名依赖系统提醒与桌面集成的用户，我想要接收原生通知、使用托盘快速访问应用，并能导出数据，以便保持良好的工作节奏。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 任务触发到期阈值 THEN 系统 SHALL 通过 Tauri Notification API 发送原生桌面提醒并展示任务标题与截止时间。\r\n2. IF 应用最小化到系统托盘 THEN 系统 SHALL 在托盘菜单提供“打开主界面”“新建任务”“退出”等快捷入口。\r\n3. WHEN 用户在设置中选择导出数据 THEN 系统 SHALL 调用 Tauri 文件访问接口，将任务与日历数据导出为 JSON 文件并提示导出路径。\r\n\r\n### Requirement 5\r\n\r\n**User Story:** 作为一名担心数据安全的用户，我想要自动本地备份和可恢复的任务数据，以确保即使设备异常也能找回信息。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 应用检测到新任务创建或更新 THEN 系统 SHALL 在后台触发增量备份，将最新任务与用户设置写入指定备份目录（默认每日不超过一次完整快照）。\r\n2. IF 用户在设置中选择“恢复最近备份” THEN 系统 SHALL 从最新有效的备份文件恢复任务与设置并在恢复前提示覆盖风险。\r\n3. WHEN 备份任务执行失败 THEN 系统 SHALL 记录失败原因并通过应用内消息中心提示用户重试。\r\n\r\n## Non-Functional Requirements\r\n\r\n### Code Architecture and Modularity\r\n- 保持前端组件、状态管理、服务层与后端 Tauri Commands 的单一职责，所有共享类型定义集中管理。\r\n- 提供模块化目录结构（如 `app`, `components`, `stores`, `services`, `commands`）以便后续扩展。\r\n- 为任务数据访问封装统一 DAO/Repository 层，避免前端直接操作数据库。\r\n- 前后端通信需提供明确的 TypeScript 类型和 Rust struct 映射，确保接口契约稳定。\r\n\r\n### Performance\r\n- 应用冷启动时间 ≤ 2 秒，热重载导航响应 ≤ 100ms。\r\n- 任务列表在 500 条记录下渲染时间 ≤ 200ms。\r\n- 日历视图切换在 200ms 内完成，拖拽更新响应 ≤ 100ms。\r\n\r\n### Security\r\n- 所有任务与设置数据默认存储在用户应用数据目录，拒绝未授权路径写入。\r\n- 本地备份文件默认加密（如采用 AES-256 对称加密，密钥由用户提供或系统生成并妥善存储）。\r\n- DeepSeek API 密钥等敏感信息通过 Tauri Secret Manager 或安全存储机制管理，不以明文写入配置文件。\r\n\r\n### Reliability\r\n- 关键数据库操作（任务 CRUD、备份）采用事务或写前日志策略，确保异常情况下数据一致性。\r\n- 备份任务支持失败重试与错误日志，定期自检备份文件完整性。\r\n- 单元测试覆盖核心数据访问与业务逻辑 ≥ 70%，确保回归安全。\r\n\r\n### Usability\r\n- UI 遵循 shadcn/ui 设计规范，提供键盘可访问性与辅助技术支持。\r\n- 所有表单字段提供即时校验与错误提示，遵循 EARS 接受标准。\r\n- 主题切换、导航、任务列表与日历交互保持一致的视觉语言与反馈，支持屏幕阅读器标签。\r\n",
  "fileStats": {
    "size": 5923,
    "lines": 90,
    "lastModified": "2025-10-07T19:24:38.848Z"
  },
  "comments": []
}