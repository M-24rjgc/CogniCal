{
  "id": "snapshot_1760711193006_kwwhtzqhk",
  "approvalId": "approval_1760710770322_jgwicva5v",
  "approvalTitle": "dashboard-simplification requirements rewrite",
  "version": 2,
  "timestamp": "2025-10-17T14:26:33.006Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# 首页仪表盘简化需求文档\r\n\r\n## Introduction\r\n\r\n当前 CogniCal 首页仪表盘聚合了任务、生产力、健康与洞察等多个模块，对首次使用者和轻量用户造成明显的信息噪声。用户调研显示：70% 的新用户希望首页先展示“今日必须关注”的卡片，再逐步探索深度分析。本次需求旨在重构首页的内容密度、控制交互复杂度，并为资深用户提供可控的模块管理能力，使仪表盘既能保持高信息价值，又不牺牲可读性与专注度。\r\n\r\n## Alignment with Product Vision\r\n\r\n该功能直接支撑产品强调的“隐私优先、AI 透明、节奏友好”原则：\r\n\r\n1. **简化决策路径**：通过默认精简视图，让用户快速洞察今日任务与风险，缩短启动时间，符合“效率提升”目标。\r\n2. **渐进式复杂度**：以模块开关的方式满足不同熟练度人群，呼应“人机协同决策”理念。\r\n3. **模块化架构**：统一模块接口并提供配置持久化，为后续插件化扩展与双智能体协同奠定基础。\r\n4. **透明呈现**：保留核心 AI 指标并以可展开的方式展示推理详情，保持高信任度与可解释性。\r\n\r\n## Requirements\r\n\r\n### Requirement 1: 默认简化首页布局\r\n\r\n**User Story:** 作为首次登录或轻量使用 CogniCal 的用户，我希望首页默认展示关键的任务与风险提醒，这样我可以快速了解今日工作重点而不被大量信息干扰。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户首次打开仪表盘 THEN 系统 SHALL 只呈现以下三个核心模块：今日任务概览、简化版生产力评分卡、即将到期任务提醒。\r\n2. WHEN 仪表盘渲染核心模块 THEN 系统 SHALL 在每个模块内提供语义化占位符与空状态文案。\r\n3. WHEN 用户点击任一模块的“展开详细信息”按钮 THEN 系统 SHALL 在同一界面内显示与该模块关联的详细视图，并支持“收起”操作恢复精简态。\r\n4. WHEN 用户重新载入应用 AND 未开启完整模式 THEN 系统 SHALL 继续使用精简布局，不展示高级模块。\r\n\r\n### Requirement 2: 仪表盘模块自定义与持久化\r\n\r\n**User Story:** 作为进阶用户，我希望自定义仪表盘模块的显示组合，这样界面能符合我的工作流，并在重启应用后保持不变。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户进入设置页 THEN 系统 SHALL 提供“仪表盘模块设置”区域，列出所有可配置模块（最少包含：生产力详情、工作负载预测、时间分配、健康概览、效率洞察、专注时长）。\r\n2. WHEN 用户勾选或取消勾选任意模块 THEN 系统 SHALL 立即更新本地可观察状态并触发仪表盘即时刷新。\r\n3. WHEN 用户修改仪表盘配置 THEN 系统 SHALL 将结果持久化到 settingsStore 所管理的配置（并通过 Tauri 持久化到本地数据库）。\r\n4. WHEN 用户点击“恢复默认”按钮 THEN 系统 SHALL 回退到精简布局的默认模块组合并删除自定义配置。\r\n5. WHEN 用户启用全部模块 THEN 系统 SHALL 自动切换到“完整仪表盘模式”，在视觉上提示已展示全部内容。\r\n\r\n### Requirement 3: 快速入口与操作效率\r\n\r\n**User Story:** 作为高频用户，我希望首页顶部提供常用操作的快捷入口，这样可以在任意时刻快速调用关键功能。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 仪表盘加载完成 THEN 系统 SHALL 在首屏顶部显示“快速操作栏”，包含“创建任务”“打开日历”“生成智能规划”三个操作。\r\n2. WHEN 用户点击快捷操作 THEN 系统 SHALL 触发对应业务流程：打开任务创建对话框、导航到日历页、导航到规划页。\r\n3. WHEN 用户通过键盘导航快速操作栏 THEN 系统 SHALL 提供逻辑顺序的焦点循环和可视化焦点样式。\r\n4. WHEN 视窗宽度低于既定断点（例如 768px） THEN 系统 SHALL 将快速操作栏切换为堆叠布局或折叠菜单，确保按钮仍可访问。\r\n\r\n### Requirement 4: 配置驱动的模块渲染与数据一致性\r\n\r\n**User Story:** 作为维护仪表盘的开发者，我需要一个配置驱动的渲染机制，这样前端与后端可以在不修改核心代码的情况下扩展或调整模块。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 仪表盘初始化 THEN 系统 SHALL 从持久化层加载模块配置（若为空则回退到默认配置）。\r\n2. WHEN Dashboard 页面渲染模块 THEN 系统 SHALL 根据配置执行条件渲染与懒加载，避免未启用模块携带数据开销。\r\n3. WHEN 数据加载失败 OR 模块渲染出错 THEN 系统 SHALL 显示优雅的降级 UI 并记录日志，而不影响其他模块。\r\n4. WHEN 后端 Schema 迁移包含仪表盘配置字段 THEN 系统 SHALL 确保数据以 JSON 格式存储并通过 Rust 与 TypeScript 的类型定义保持一致。\r\n5. WHEN 用户切换主题或窗口大小 THEN 系统 SHALL 维持模块渲染顺序与配置一致性，不出现闪烁或重复加载。\r\n\r\n## Non-Functional Requirements\r\n\r\n### Code Architecture and Modularity\r\n- 仪表盘模块必须以独立组件存在，并通过统一接口声明所需数据与显示条件。\r\n- settingsStore、tauriApi 与后端命令须各自承担状态、调用、持久化职责，避免跨层耦合。\r\n- 类型定义应集中在 `src/types/dashboard.ts` 与相关 settings 类型中，确保前后端一致。\r\n- Dashboard 页面负责组合模块，不直接持有业务逻辑；业务逻辑封装在 hooks 或 stores。\r\n\r\n### Performance\r\n- 首屏加载（核心模块 + 快速操作栏）在常规设备上应控制在 500ms 内完成。\r\n- 未启用的模块必须懒加载，确保不引入额外的网络或计算开销。\r\n- 设置变更后的重新渲染帧率应保持 ≥ 55 FPS，不出现明显卡顿。\r\n\r\n### Security\r\n- 仪表盘配置写入 Tauri 前需进行 schema 验证，避免恶意注入。\r\n- 前端调用命令时需捕获并处理错误，避免在 UI 中泄露堆栈或敏感路径。\r\n- 不在仪表盘展示任何机密或原始 API 响应数据。\r\n\r\n### Reliability\r\n- 离线状态下应读取最近一次成功保存的仪表盘配置；若失败则回退到默认配置。\r\n- 配置更新与数据库写入需具备幂等性与失败重试机制，避免状态错乱。\r\n- 任意一个模块不可用时，其余模块必须保持可视化与交互正常。\r\n\r\n### Usability\r\n- 所有新组件需支持键盘导航、ARIA 标签、屏幕阅读器朗读。\r\n- 模块展开/收起动画时长不超过 200ms，并提供清晰的过渡状态。\r\n- 设置界面与仪表盘需提供明确的状态提示（例如“已恢复默认设置”）。\r\n- 暗黑模式与浅色模式都要保证对比度与信息层级清晰。\r\n",
  "fileStats": {
    "size": 6792,
    "lines": 92,
    "lastModified": "2025-10-17T14:19:18.654Z"
  },
  "comments": []
}