{
  "id": "snapshot_1760695328583_17i0i5bis",
  "approvalId": "approval_1760695328489_hlhincj4j",
  "approvalTitle": "首页仪表盘简化任务分解文档",
  "version": 1,
  "timestamp": "2025-10-17T10:02:08.583Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Tasks Document\r\n\r\n- [ ] 1. Create dashboard configuration types in src/types/dashboard.ts\r\n  - File: src/types/dashboard.ts\r\n  - Define TypeScript interfaces for dashboard configuration and module definitions\r\n  - Create DashboardConfig, DashboardModule, and QuickAction interfaces\r\n  - Purpose: Establish type safety for dashboard customization features\r\n  - _Leverage: src/types/settings.ts, src/types/task.ts_\r\n  - _Requirements: Requirement 2, Requirement 4_\r\n  - _Prompt: Role: TypeScript Developer specializing in type systems and interfaces | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create comprehensive TypeScript interfaces for dashboard configuration following the design document, including DashboardConfig, DashboardModule, and QuickAction interfaces, extending patterns from existing types in src/types/settings.ts and src/types/task.ts | Restrictions: Do not modify existing type files, maintain strict type safety, follow project naming conventions, ensure interfaces are serializable for database storage | Success: All interfaces compile without errors, proper type coverage for all dashboard configuration scenarios, interfaces support JSON serialization_\r\n\r\n- [ ] 2. Extend settings store with dashboard configuration in src/stores/settingsStore.ts\r\n  - File: src/stores/settingsStore.ts\r\n  - Add dashboard configuration state and methods to existing settings store\r\n  - Implement loadDashboardConfig, updateDashboardConfig, resetDashboardConfig, and toggleModule methods\r\n  - Purpose: Provide centralized state management for dashboard customization\r\n  - _Leverage: Existing settingsStore structure, src/services/tauriApi.ts_\r\n  - _Requirements: Requirement 2, Requirement 4_\r\n  - _Prompt: Role: React State Management Specialist with expertise in Zustand | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Extend the existing settingsStore with dashboard configuration state and methods, following the established patterns in the store, including proper error handling and async state management | Restrictions: Do not break existing settings functionality, maintain backward compatibility, follow existing async patterns, ensure proper TypeScript typing | Success: Dashboard configuration can be loaded, updated, and persisted correctly, all new methods integrate seamlessly with existing store patterns_\r\n\r\n- [ ] 3. Create ModuleContainer component in src/components/dashboard/ModuleContainer.tsx\r\n  - File: src/components/dashboard/ModuleContainer.tsx\r\n  - Implement reusable container component for dashboard modules with conditional rendering and lazy loading\r\n  - Add support for module visibility control and loading states\r\n  - Purpose: Provide consistent wrapper for all dashboard modules\r\n  - _Leverage: src/components/ui/card.tsx, existing component patterns_\r\n  - _Requirements: Requirement 1, Requirement 2_\r\n  - _Prompt: Role: React Component Developer with expertise in component composition and performance optimization | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create a ModuleContainer component that supports conditional rendering, lazy loading, and consistent styling, following existing component patterns from the codebase | Restrictions: Must use existing UI components from shadcn/ui, implement proper loading states, ensure accessibility, follow React best practices for performance | Success: ModuleContainer renders modules conditionally, supports lazy loading, provides consistent styling and loading states_\r\n\r\n- [ ] 4. Create QuickActionsBar component in src/components/dashboard/QuickActionsBar.tsx\r\n  - File: src/components/dashboard/QuickActionsBar.tsx\r\n  - Implement top action bar with quick access to create task, calendar, and smart planning\r\n  - Add responsive design and keyboard navigation support\r\n  - Purpose: Provide quick access to frequently used functions\r\n  - _Leverage: src/components/ui/button.tsx, existing icon system, React Router_\r\n  - _Requirements: Requirement 3_\r\n  - _Prompt: Role: React UI Developer with expertise in responsive design and accessibility | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create a QuickActionsBar component with three main actions (create task, open calendar, generate smart plan), ensuring responsive design and keyboard navigation | Restrictions: Must use existing button components and icons, implement proper ARIA labels, ensure mobile-friendly layout, follow existing navigation patterns | Success: QuickActionsBar displays three action buttons, is fully responsive, supports keyboard navigation, integrates with existing routing system_\r\n\r\n- [ ] 5. Create TodayTasksOverview component in src/components/dashboard/TodayTasksOverview.tsx\r\n  - File: src/components/dashboard/TodayTasksOverview.tsx\r\n  - Implement today's tasks overview with key metrics and quick actions\r\n  - Add task filtering and status indicators\r\n  - Purpose: Provide at-a-glance view of today's tasks\r\n  - _Leverage: src/hooks/useTasks.ts, existing task components, src/components/ui/badge.tsx_\r\n  - _Requirements: Requirement 1_\r\n  - _Prompt: Role: React Developer with expertise in data visualization and task management interfaces | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create a TodayTasksOverview component that displays today's tasks with key metrics, status indicators, and quick actions, leveraging existing task management patterns | Restrictions: Must use existing task hooks and components, implement proper loading states, ensure task data is filtered correctly for today, follow existing task interaction patterns | Success: Component shows today's tasks with completion status, provides quick task actions, displays relevant metrics like completion rate_\r\n\r\n- [ ] 6. Create UpcomingTasksAlert component in src/components/dashboard/UpcomingTasksAlert.tsx\r\n  - File: src/components/dashboard/UpcomingTasksAlert.tsx\r\n  - Implement alert component for tasks due soon with configurable time thresholds\r\n  - Add severity levels and visual indicators\r\n  - Purpose: Warn users about upcoming deadlines\r\n  - _Leverage: src/components/ui/alert.tsx, src/hooks/useTasks.ts, existing date utilities_\r\n  - _Requirements: Requirement 1_\r\n  - _Prompt: Role: React Developer with expertise in alert systems and time-based notifications | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create an UpcomingTasksAlert component that shows tasks due within configurable time thresholds, with appropriate severity levels and visual indicators | Restrictions: Must use existing alert components, implement proper time calculations, support configurable thresholds, ensure accessibility with proper ARIA labels | Success: Alert shows upcoming tasks with appropriate urgency levels, time calculations are accurate, component is accessible and informative_\r\n\r\n- [ ] 7. Create simplified ProductivityScoreCard in src/components/dashboard/ProductivityScoreCard.tsx\r\n  - File: src/components/dashboard/ProductivityScoreCard.tsx\r\n  - Implement simplified version of existing productivity score card with expandable details\r\n  - Add core metrics display and optional detailed view\r\n  - Purpose: Provide simplified productivity overview with option for details\r\n  - _Leverage: Existing ProductivityScoreCard patterns, src/hooks/useProductivityScore.ts_\r\n  - _Requirements: Requirement 1_\r\n  - _Prompt: Role: React Component Developer with expertise in data visualization and progressive disclosure | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create a simplified ProductivityScoreCard that shows core metrics by default with expandable detailed view, following existing productivity score patterns | Restrictions: Must reuse existing productivity score logic, implement progressive disclosure pattern, maintain visual consistency with existing score cards, ensure smooth transitions | Success: Component displays simplified productivity metrics by default, details can be expanded, maintains consistency with existing productivity visualization_\r\n\r\n- [ ] 8. Create DashboardSettingsForm component in src/components/settings/DashboardSettingsForm.tsx\r\n  - File: src/components/settings/DashboardSettingsForm.tsx\r\n  - Implement settings form for dashboard module configuration with checkboxes and switches\r\n  - Add preview functionality and reset to defaults option\r\n  - Purpose: Allow users to customize dashboard module visibility\r\n  - _Leverage: Existing settings form patterns, src/components/ui/switch.tsx, src/components/ui/checkbox.tsx_\r\n  - _Requirements: Requirement 2_\r\n  - _Prompt: Role: React Form Developer with expertise in settings interfaces and user preferences | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create a DashboardSettingsForm that allows users to toggle dashboard module visibility, with checkboxes for optional modules and a reset to defaults option | Restrictions: Must follow existing settings form patterns, use existing form components, implement proper state management, ensure form validation and accessibility | Success: Form allows toggling all dashboard modules, changes persist correctly, reset to defaults works, form is accessible and user-friendly_\r\n\r\n- [ ] 9. Integrate dashboard settings into Settings page in src/pages/Settings.tsx\r\n  - File: src/pages/Settings.tsx\r\n  - Add dashboard configuration section to existing settings page\r\n  - Integrate DashboardSettingsForm component with proper routing and layout\r\n  - Purpose: Provide access to dashboard customization from main settings\r\n  - _Leverage: Existing settings page structure, settings navigation_\r\n  - _Requirements: Requirement 2_\r\n  - _Prompt: Role: React Page Integration Specialist with expertise in settings page architecture | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Integrate the DashboardSettingsForm into the existing Settings page, adding a new section for dashboard configuration with proper navigation and layout | Restrictions: Do not break existing settings functionality, follow existing settings page patterns, ensure proper tab navigation, maintain responsive design | Success: Dashboard settings appear as new section in settings page, navigation works correctly, existing settings remain functional_\r\n\r\n- [ ] 10. Refactor Dashboard page in src/pages/Dashboard.tsx\r\n  - File: src/pages/Dashboard.tsx\r\n  - Restructure main dashboard to use new modular architecture with configuration-driven rendering\r\n  - Add QuickActionsBar and implement conditional module rendering\r\n  - Purpose: Implement simplified dashboard with customizable modules\r\n  - _Leverage: Existing dashboard structure, all new dashboard components_\r\n  - _Requirements: Requirement 1, Requirement 2, Requirement 3, Requirement 4_\r\n  - _Prompt: Role: React Architect with expertise in page composition and state management | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Refactor the Dashboard page to use the new modular architecture, integrating QuickActionsBar, implementing configuration-driven module rendering, and ensuring proper state management | Restrictions: Must maintain existing functionality while adding new features, ensure smooth transitions, implement proper loading states, maintain responsive design, preserve existing analytics and wellness features | Success: Dashboard renders modules based on user configuration, shows simplified layout by default, all existing functionality remains accessible, page performance is maintained_\r\n\r\n- [ ] 11. Add Tauri command for dashboard configuration persistence in src-tauri/src/commands/settings.rs\r\n  - File: src-tauri/src/commands/settings.rs\r\n  - Add Rust command for saving and loading dashboard configuration to/from database\r\n  - Implement proper error handling and validation\r\n  - Purpose: Provide backend support for dashboard configuration persistence\r\n  - _Leverage: Existing settings command patterns, database connection_\r\n  - _Requirements: Requirement 2, Requirement 4_\r\n  - _Prompt: Role: Rust/Tauri Backend Developer with expertise in command implementation and database operations | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Add Tauri commands for dashboard configuration persistence, following existing settings command patterns and implementing proper error handling | Restrictions: Must follow existing command patterns, implement proper JSON serialization, add validation, ensure database transaction safety, maintain error consistency | Success: Dashboard configuration can be saved and loaded reliably, commands handle errors gracefully, data persists across app restarts_\r\n\r\n- [ ] 12. Update database schema in src-tauri/src/db/migrations.rs\r\n  - File: src-tauri/src/db/migrations.rs\r\n  - Add migration for dashboard_config column to settings table\r\n  - Implement proper data migration and default values\r\n  - Purpose: Extend database schema to support dashboard configuration storage\r\n  - _Leverage: Existing migration patterns, database schema_\r\n  - _Requirements: Requirement 2, Requirement 4_\r\n  - _Prompt: Role: Database Migration Specialist with expertise in SQLite schema evolution | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create database migration for adding dashboard_config column to settings table with proper default values and data type handling | Restrictions: Must follow existing migration patterns, ensure backward compatibility, use appropriate JSON data type, provide sensible defaults, handle migration errors safely | Success: Migration runs successfully, dashboard_config column is added with proper defaults, existing data remains intact, schema supports required configuration storage_\r\n\r\n- [ ] 13. Update tauriApi service in src/services/tauriApi.ts\r\n  - File: src/services/tauriApi.ts\r\n  - Add TypeScript functions for dashboard configuration API calls\r\n  - Implement proper error handling and type safety\r\n  - Purpose: Provide frontend interface to dashboard configuration commands\r\n  - _Leverage: Existing API patterns, error handling_\r\n  - _Requirements: Requirement 2, Requirement 4_\r\n  - _Prompt: Role: TypeScript API Integration Specialist with expertise in Tauri command invocation | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Add TypeScript functions to tauriApi.ts for dashboard configuration operations, following existing API patterns and ensuring proper error handling | Restrictions: Must follow existing API call patterns, implement proper type safety, handle errors consistently, ensure async operations are properly managed | Success: API functions correctly invoke backend commands, handle errors appropriately, provide type-safe interfaces for frontend components_\r\n\r\n- [ ] 14. Add dashboard configuration to AppSettings types in src/types/settings.ts\r\n  - File: src/types/settings.ts\r\n  - Extend AppSettings interface to include dashboard configuration field\r\n  - Ensure proper type alignment with backend models\r\n  - Purpose: Maintain type consistency between frontend and backend\r\n  - _Leverage: Existing AppSettings interface patterns_\r\n  - _Requirements: Requirement 2, Requirement 4_\r\n  - _Prompt: Role: TypeScript Type Specialist with expertise in interface design and type consistency | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Extend the AppSettings interface to include dashboard configuration, ensuring type alignment with the new dashboard configuration types and backend models | Restrictions: Do not break existing settings functionality, maintain backward compatibility, ensure proper JSON serialization, follow existing type patterns | Success: AppSettings interface includes dashboard configuration, type consistency is maintained, existing settings functionality remains unaffected_\r\n\r\n- [ ] 15. Create dashboard integration tests in src/__tests__/dashboard.integration.test.tsx\r\n  - File: src/__tests__/dashboard.integration.test.tsx\r\n  - Write integration tests for dashboard configuration and module rendering\r\n  - Test user interactions from settings changes to dashboard updates\r\n  - Purpose: Ensure dashboard customization works end-to-end\r\n  - _Leverage: Existing test patterns, React Testing Library_\r\n  - _Requirements: Requirement 1, Requirement 2, Requirement 3, Requirement 4_\r\n  - _Prompt: Role: QA Engineer with expertise in React integration testing and user interaction testing | Task: Implement the task for spec dashboard-simplification, first run spec-workflow-guide to get the workflow guide then implement the task: Create comprehensive integration tests for dashboard functionality, covering configuration changes, module rendering, and user interactions from settings to dashboard display | Restrictions: Must follow existing test patterns, test user workflows comprehensively, ensure tests are maintainable, cover both success and error scenarios | Success: Integration tests verify dashboard configuration works correctly, user interactions are tested end-to-end, tests provide good coverage of dashboard functionality_",
  "fileStats": {
    "size": 18122,
    "lines": 136,
    "lastModified": "2025-10-17T10:01:58.361Z"
  },
  "comments": []
}